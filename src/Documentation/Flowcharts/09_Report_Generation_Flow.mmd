%% QUY TRÌNH TẠO BÁO CÁO
%% Tối ưu cho Draw.io import

flowchart TD
    A[Admin chọn loại báo cáo] --> B[Thiết lập tham số báo cáo]
    B --> C[Chọn khoảng thời gian]
    C --> D[Chọn bộ lọc dữ liệu]
    D --> E[Xác nhận tham số]
    E --> F[Thu thập dữ liệu từ database]
    
    F --> G{Có dữ liệu?}
    G -->|Không| H[Thông báo không có dữ liệu]
    G -->|Có| I[Xử lý và tính toán dữ liệu]
    
    I --> J[Tạo biểu đồ và visualization]
    J --> K[Tạo bảng thống kê]
    K --> L[Render báo cáo HTML]
    L --> M[Hiển thị báo cáo trên màn hình]
    
    M --> N{Người dùng muốn xuất file?}
    N -->|Không| O[Kết thúc xem báo cáo]
    N -->|Có| P{Định dạng xuất?}
    
    P -->|PDF| Q[Generate PDF file]
    P -->|Excel| R[Generate Excel file]
    P -->|CSV| S[Generate CSV file]
    
    Q --> T[Tải file PDF]
    R --> U[Tải file Excel]
    S --> V[Tải file CSV]
    
    T --> W[Hoàn tất xuất báo cáo]
    U --> W
    V --> W
    
    H --> X[Đề xuất thay đổi bộ lọc]
    X --> D

    %% Styling
    classDef startNode fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef successNode fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef errorNode fill:#ffebee,stroke:#d32f2f,stroke-width:2px
    classDef warningNode fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef decisionNode fill:#e1f5fe,stroke:#0288d1,stroke-width:2px

    class A startNode
    class O,W successNode
    class H errorNode
    class X warningNode
    class G,N,P decisionNode
